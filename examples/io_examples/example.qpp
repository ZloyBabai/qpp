molecule Ca4F8_embed(0d,real=double)
{
  fragment CaF2_UC(3d,format(atom,x,y,z,charge=real))
  {
    Ca  0.00  0.00  0.00   2.00
    F   1.38  1.38  1.38  -0.25
    F   1.38  1.38 -1.38  -0.25
    F   1.38 -1.38  1.38  -0.25
    F   1.38 -1.38 -1.38  -0.25
    F  -1.38  1.38  1.38  -0.25
    F  -1.38  1.38 -1.38  -0.25
    F  -1.38 -1.38  1.38  -0.25
    F  -1.38 -1.38 -1.38  -0.25
  }

  vectors CaF2(3d){
    2.76 2.76 0.00
    2.76 0.00 2.76
    0.00 2.76 2.76
  }

  geom1 = replicate(uc = CaF2_UC, 
    shape = subtract(union(sphere(R(25.0),center(0,0,0)), sphere(R=15,center(20,0,0))), 
       box(a=20,b=20,c=20,corner(-20,-20,-20))),
    symm = CaF2,  mode(join,cellwise), close=.1);

  replace(geom1, sphere(R=15.0), Ca, Sr);
  replace(geom1, sphere(R=15.0), F,  Cl );

  fragment QM_cluster(dim=0){
    F_QM   0.00  0.00  0.00
    F_QM   2.76  0.00  0.00
    F_QM  -2.76  0.00  0.00
    F_QM   0.00  2.76  0.00
    F_QM   0.00 -2.76  0.00
    F_QM   0.00  0.00  2.76 
    F_QM   0.00  0.00 -2.76 
    Ca_QM  1.38  1.38  1.38
    Ca_QM  1.38 -1.38 -1.38
    Ca_QM -1.38  1.38 -1.38
    Ca_QM  1.38 -1.38  1.38
  }


  atom Ca_QM{
    number = 20;
    basis(bastype=gauss){
      shell(f1s=0){
        35264.8600000000  0.00181400
         5295.5030000000  0.01388500
         1206.0200000000  0.06836200
          339.6839000000  0.23561900
          108.6264000000  0.48206400
           36.9210300000  0.34298200
        }
      shell(f2s=0,f2p=1){
           706.3096000000  0.00244800  0.00402000
           167.8187000000  0.03241500  0.03100600
            53.8255800000  0.12262200  0.13372800
            20.0163800000 -0.04317000  0.33679800
             7.9702790000 -0.61269900  0.46312800
             3.2120590000 -0.44875400  0.22575300
      }
      shell(f3s=0,f2p=1){
            14.1951800000  0.01084500 -0.01289600
             4.8808280000  0.20883300 -0.01025200
             2.1603900000  0.03150300  0.19597800
             0.9878990000 -0.55265200  0.43579300
             0.4495170000 -0.54380000  0.39964500
             0.1873870000 -0.06669300  0.09713600
      }
      shell(f4s=0,f4p=1){
             1.0322710000 -0.04439700 -0.42986200
             0.3811710000 -0.32845600  0.00693600
             0.0651310000  1.16301000  0.97059300
      }
      shell(f5s=0,f5p=1){
             0.0260100000  1.00000000  1.00000000
      }
      shell(f3d=2){
            10.1106700000  0.08747700
             2.5587690000  0.37956300
             0.7434200000  0.71803900
      }
      shell(f4d=2){
             0.2008780000  1.00000000
      }
      shell(f5d=2){
             0.07 1.
      }
    }
  }

  atom F_QM{
    number(9);
    basis = 6-31G;
  }

  atom Ca_cls{
    number = 20;
    charge(2.0);
  }

  atom F_cls{
    number = 9;
    charge = -1.0;
    alpha = 0.5;
  }

  basis(bastype=gauss,angtype=cartesian,real=double)
  {
    center(Ca_qm){
      shell(f1s=0){
        35264.8600000000  0.00181400
         5295.5030000000  0.01388500
         1206.0200000000  0.06836200
          339.6839000000  0.23561900
          108.6264000000  0.48206400
           36.9210300000  0.34298200
        }
      shell(f2s=0,f2p=1){
           706.3096000000  0.00244800  0.00402000
           167.8187000000  0.03241500  0.03100600
            53.8255800000  0.12262200  0.13372800
            20.0163800000 -0.04317000  0.33679800
             7.9702790000 -0.61269900  0.46312800
             3.2120590000 -0.44875400  0.22575300
      }
      shell(f3s=0,f2p=1){
            14.1951800000  0.01084500 -0.01289600
             4.8808280000  0.20883300 -0.01025200
             2.1603900000  0.03150300  0.19597800
             0.9878990000 -0.55265200  0.43579300
             0.4495170000 -0.54380000  0.39964500
             0.1873870000 -0.06669300  0.09713600
      }
      shell(f4s=0,f4p=1){
             1.0322710000 -0.04439700 -0.42986200
             0.3811710000 -0.32845600  0.00693600
             0.0651310000  1.16301000  0.97059300
      }
      shell(f5s=0,f5p=1){
             0.0260100000  1.00000000  1.00000000
      }
      shell(f3d=2){
            10.1106700000  0.08747700
             2.5587690000  0.37956300
             0.7434200000  0.71803900
      }
      shell(f4d=2){
             0.2008780000  1.00000000
      }
      shell(f5d=2){
             0.07 1.
      }
    }
    
    center(F_qm);
    basis=6-311G*;
    
    center(1,2,3,Ce);
    shell(ce1s(0),ce2s(0)){
        5.0 .7  .7
        2.0 .7 -.7
    }

  }

  guess(huckel);
  
  scf(method(diis(1)));
  scf(diis);

  output(format=pcg);

}
